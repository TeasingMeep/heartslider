/*❤ HeartSlider v3.4.4 ❤ */class HeartSlider{constructor(userSettings){this.reset(userSettings)}reset(userSettings){var _Mathfloor=Math.floor,_this=this;for(var prop in _this.settings={buttons:!1,clickToAdvance:!1,delay:1e3,effect:"fadeOut",loop:!0,manualTransition:400,paused:!1,pauseOnInactiveWindow:!1,progressive:!0,randomize:!1,slideshow:".heart-slideshow",slides:".heart-slide",swipe:!0,transition:3e3,progressIndicators:{enable:!1,type:"dash",clickable:!0,color:"#fff"}},userSettings)if(this.settings.hasOwnProperty(prop))if("object"==typeof userSettings[prop]&&"slideshow"!==prop)for(const subProp in userSettings[prop].enable=!0,userSettings[prop]){const value=userSettings[prop][subProp];this.settings[prop].hasOwnProperty(subProp)&&(this.settings[prop][subProp]=value)}else this.settings[prop]=userSettings[prop];if(this.slideshowSelector="object"==typeof _this.settings.slideshow?_this.settings.slideshow:document.querySelector(_this.settings.slideshow),!this.slideshowSelector)return!1;if(this.slideshowSelector.classList.contains("heart-slideshow")||this.slideshowSelector.classList.add("heart-slideshow"),this.slides=Array.prototype.slice.apply(this.slideshowSelector.querySelectorAll(this.settings.slides)),0===this.slides.length){const directChildren=this.slideshowSelector.children;this.slides=[...directChildren].filter(child=>"BUTTON"!==child.tagName)}if(this.total=this.slides.length,this.index=0,this.manualTimeout,this.originallyPaused=this.settings.paused,this.settings.randomize&&(this.index=_Mathfloor(Math.random()*this.total)),this.settings.progressive&&this.progressiveLoad(this.index,!0,this),this.firstIndex=this.index,this.slides.forEach(function(slide,index){index!==_this.firstIndex&&(slide.setAttribute("aria-hidden","true"),slide.setAttribute("tab-index","-1")),slide.classList.contains("heart-slide")||slide.classList.add("heart-slide"),_this.settings.swipe&&slide.setAttribute("draggable","true")}),this.goToSlide(this.firstIndex,!1,!0),2>this.slides.length)return!1;_this.settings.progressive||setTimeout(function(){_this.slideshowSelector.classList.add("progressive-loading-disabled"),_this.kickstart()},100);if(_this.settings.pauseOnInactiveWindow&&document.addEventListener("visibilitychange",function(){return _this.heartVisibilityHandler(_this)},!0),_this.settings.swipe&&(_this.slideshowSelector.addEventListener("touchstart",_this.swipeHandler(_this).handleTouchStart,{passive:!0}),_this.slideshowSelector.addEventListener("touchmove",_this.swipeHandler(_this).handleTouchMove,{passive:!0})),_this.settings.clickToAdvance){var throttleClick;_this.slideshowSelector.addEventListener("click",function(event){throttleClick||"BUTTON"===event.target.nodeName||(_this.pause(),_this.next(_this,!0,!1,!0),throttleClick=setTimeout(function(){throttleClick=void 0},_this.settings.manualTransition),!_this.originallyPaused&&(_this.throttleClickResume&&clearTimeout(_this.throttleClickResume),_this.throttleClickResume=setTimeout(function(){_this.resume()},_this.settings.transition+1.25*_this.settings.delay)))},!1)}if(this.settings.progressIndicators&&this.settings.progressIndicators.enable){const progressContainer=this.slideshowSelector.querySelector(".progress-container")?this.slideshowSelector.querySelector(".progress-container"):document.createElement("div");progressContainer.classList.add("progress-container");const type=this.settings.progressIndicators.type||"dash";progressContainer.classList.add("type-"+type);const indicatorColor=this.settings.progressIndicators.color||"#fff";("#fff"!==indicatorColor||"#ffffff"!==indicatorColor||"white"!==indicatorColor||"rgb(255, 255, 255)"!==indicatorColor||"rgba(255, 255, 255, 1)"!==indicatorColor)&&progressContainer.style.setProperty("--indicator-color",indicatorColor);const indicatorType=this.settings.progressIndicators.clickable?"button":"div";progressContainer.style.setProperty("--total",this.total),0<progressContainer.childElementCount&&(progressContainer.innerHTML="");for(let index=0;index<this.total;index++){const indicator=document.createElement(indicatorType);indicator.classList.add("indicator"),indicator.setAttribute("data-index",index),indicator.addEventListener("click",()=>{if(index===this.index)return;_this.pause();_this.goToSlide(index,!0,!1,!0),throttleClick=setTimeout(function(){throttleClick=void 0},_this.settings.manualTransition),_this.originallyPaused||(_this.throttleClickResume&&clearTimeout(_this.throttleClickResume),_this.throttleClickResume=setTimeout(function(){_this.resume()},_this.settings.transition+1*_this.settings.delay))}),progressContainer.appendChild(indicator)}this.slideshowSelector.appendChild(progressContainer),this.progressContainerSelector=progressContainer,this.progressIndicators=progressContainer.querySelectorAll(".indicator"),window.requestAnimationFrame(()=>{this.progressIndicators[this.firstIndex].classList.add("active","first")})}const slideshowButtons=_this.slideshowSelector.querySelectorAll("button[class*='heart-']");if(_this.settings.buttons||2===slideshowButtons.length){function buttonHandler(button){throttleClick||(_this.pause(),button.classList.contains("heart-next")?_this.next(_this,!0,!1,!0):button.classList.contains("heart-prev")&&_this.previous(_this,!0,!1,!0),throttleClick=setTimeout(function(){throttleClick=void 0},200))}if(0===slideshowButtons.length){const buttonClasses=["heart-prev","heart-next"];for(var button,i=0;i<buttonClasses.length;i++)button=document.createElement("button"),button.classList.add(buttonClasses[i]),button.setAttribute("aria-label",buttonClasses[i].replace("heart-","")),button.setAttribute("tab-index","0"),button.addEventListener("click",function(e){buttonHandler(e.currentTarget)},!1),_this.slideshowSelector.appendChild(button)}else for(const button of slideshowButtons){button.setAttribute("tab-index","0");const ariaLabel=button.classList.contains("heart-prev")?"prev":"next";button.setAttribute("aria-label",ariaLabel),button.addEventListener("click",function(e){buttonHandler(e.currentTarget)},!1)}}}kickstart(){const _this=this;if(_this.settings.progressive){_this.slideshowSelector.classList.add("first-image-loaded"),_this.firstImageLoad&&_this.firstImageLoad(_this);var startProgressiveLoad=function(){setTimeout(function(){_this.progressiveLoad((_this.firstIndex+1+_this.total)%_this.total)},_this.settings.delay)};window.requestAnimationFrame(startProgressiveLoad)}_this.settings.paused||(_this.kickoffTimer=setTimeout(function(){_this.resume(),_this.kickoffTimer=void 0},.5*_this.settings.delay+_this.settings.transition))}on(type,callback){const _this=this,supportedEvents=["transitionStart","transitionEnd","firstImageLoad"];if(!supportedEvents.includes(type))console.warn("\""+type+"\" is not a valid event. Try one of these:",supportedEvents);else if("function"==typeof callback){function callbackHandler(_this){let event=new CustomEvent(type,{detail:{slideshow:_this}});_this.slideshowSelector.dispatchEvent(event),callback(event.detail.slideshow,event.detail.slideshow.slideshowSelector,event.detail.slideshow.currentSlide)}"transitionStart"===type&&(_this.transitionStart=function(_this){callbackHandler(_this)}),"transitionEnd"===type&&(_this.transitionEnd=function(_this){callbackHandler(_this)}),"firstImageLoad"===type&&(_this.firstImageLoad=function(_this){callbackHandler(_this)})}else console.warn("Your second argument for "+type+" must be a function.")}swipeHandler(_this){function getTouches(evt){return evt.touches||evt.originalEvent.touches}function handleTouchStart(evt){const firstTouch=getTouches(evt)[0];this.xDown=firstTouch.clientX,this.yDown=firstTouch.clientY}function handleTouchMove(evt){var _Mathabs=Math.abs;if(this.xDown&&this.yDown){var xUp=evt.touches[0].clientX,yUp=evt.touches[0].clientY,xDiff=this.xDown-xUp,yDiff=this.yDown-yUp;_Mathabs(xDiff)>_Mathabs(yDiff)&&(0<xDiff?(evt.preventDefault(),_this.pause(),_this.next(_this,!0,!1,!0)):(evt.preventDefault(),_this.pause(),_this.previous(_this,!0,!1,!0))),this.xDown=null,this.yDown=null}}return this.xDown=null,this.yDown=null,{getTouches:getTouches,handleTouchStart:handleTouchStart,handleTouchMove:handleTouchMove}}heartVisibilityHandler(_this){if(void 0===_this&&(_this=this),null!==_this&&_this.settings.pauseOnInactiveWindow&&null!==_this.settings.slideshow)if("hidden"==document.visibilityState){console.log("%cWindow Lost Focus. HeartSlider is Paused.","font-style: italic; font-size: 0.9em; color: #757575; padding: 0.2em;"),_this.pause();let prevSlideOpacity=window.getComputedStyle(_this.previousSlide).opacity;_this.previousSlide.style.opacity=prevSlideOpacity,_this.previousSlide.style.transitionDuration="0"}else _this.previousSlide.style.opacity="",console.log("%cRegained Focus. Resumed HeartSlider.","font-style: italic; font-size: 0.9em; color: #6F9F67; padding: 0.2em;"),_this.currentSlide.transitionDuration=0,console.log(`resuming in ${.75*_this.settings.delay}ms`),_this.visResumeTimer=setTimeout(_this.resume.bind(_this),.75*_this.settings.delay)}goToSlide(targetIndex,isManuallyCalled,isFirstSlide,skipDefaultTransition){if(void 0===isManuallyCalled&&(isManuallyCalled=!1),void 0===isFirstSlide&&(isFirstSlide=!1),void 0===skipDefaultTransition&&(skipDefaultTransition=!1),this.transitioning&&!skipDefaultTransition)return!1;if(!this.settings.loop&&!isFirstSlide&&targetIndex===this.firstIndex)return this.pause(),!1;this.transitioning=!0,null!==this.slides[targetIndex]&&this.slides[targetIndex].querySelector("video")&&this.clearAllTimers();var _this=this;this.previousSlide=this.slides[this.index];var newTargetIndex=(targetIndex+this.total)%this.total;this.currentSlide=this.slides[newTargetIndex];const progressContainerSelector=this.progressContainerSelector,progressIndicators=this.progressIndicators;if(void 0!==progressContainerSelector&&0<progressIndicators.length){const activeIndicator=progressIndicators[newTargetIndex],alreadyActiveIndicators=progressContainerSelector.querySelectorAll(".active");for(const activeIndicator of alreadyActiveIndicators)activeIndicator.classList.remove("active","first");activeIndicator.classList.add("active")}var duration=isManuallyCalled||isFirstSlide||skipDefaultTransition?_this.settings.manualTransition:_this.settings.transition;this.index=newTargetIndex,isFirstSlide||this.progressiveLoad(newTargetIndex),this.progressiveLoad((newTargetIndex+1+_this.total)%_this.total),window.requestAnimationFrame(function changeSlides(){let prevSlideProgress=1;if(_this.previousSlide===_this.currentSlide&&skipDefaultTransition){clearTimeout(_this.manualTimeout),clearInterval(_this.slideInterval);const prevSlideOpacity=window.getComputedStyle(_this.previousSlide).opacity;prevSlideProgress=1-prevSlideOpacity,_this.previousSlide.style.opacity=prevSlideOpacity,_this.previousSlide.style.transition="none",setTimeout(function(){_this.previousSlide.style.transition="opacity",_this.previousSlide.style.transitionDelay="0ms",_this.previousSlide.style.transitionDuration=duration*prevSlideProgress+"ms",_this.previousSlide.style.opacity=null},16.6667)}else _this.previousSlide!==_this.currentSlide&&(_this.previousSlide.style.transitionDelay=duration+"ms",_this.previousSlide.style.transitionDuration="0ms",_this.previousSlide.classList.remove("active"));const videoElement=_this.currentSlide.querySelector("video");if(null!==videoElement){function adjustSlideTime(videoElement){var _Mathmax=Math.max;const totalDuration=_this.settings.delay+2*_this.settings.transition,videoSlideDuration=_Mathmax(1e3*videoElement.duration-totalDuration,0);0<=videoSlideDuration&&(_this.pause(),_this.videoSlideTimer&&clearTimeout(_this.videoSlideTimer),_this.videoSlideTimer=setTimeout(function(){_this.resume()},videoSlideDuration+_this.settings.transition))}videoElement.currentTime=0,videoElement.play(),videoElement.duration&&"number"==typeof videoElement.duration?adjustSlideTime(videoElement):videoElement.onloadedmetadata=function(){adjustSlideTime(videoElement)}}_this.currentSlide.style.transitionDelay="0ms",_this.currentSlide.style.transitionDuration=duration+"ms",_this.currentSlide.removeAttribute("aria-hidden"),_this.currentSlide.removeAttribute("tab-index"),_this.currentSlide.classList.add("active"),_this.transitionEndTimer&&clearTimeout(_this.transitionEndTimer),_this.transitionStart&&_this.transitionStart(_this),_this.transitionEndTimer=setTimeout(function(){if(_this.previousSlide.style.transitionDelay="0ms",_this.previousSlide.style.transitionDuration="0ms",!isFirstSlide){_this.previousSlide.setAttribute("aria-hidden","true"),_this.previousSlide.setAttribute("tab-index","-1"),_this.transitionEnd&&_this.transitionEnd(_this);const videoElement=_this.previousSlide.querySelector("video");null!==videoElement&&(videoElement.pause(),videoElement.currentTime=0)}_this.transitioning=!1,_this.transitionEndTimer=void 0},duration*prevSlideProgress)})}progressiveLoad(target,isFirstSlide,_this){void 0===isFirstSlide&&(isFirstSlide=!1),void 0===_this&&(_this=this);const targetSlide=this.slides[target];if(null!==targetSlide){var currentImages=Array.prototype.slice.call(targetSlide.querySelectorAll("img"));!!currentImages&&0<currentImages.length&&currentImages.forEach((currentImage,index)=>{if(!(null==currentImage||currentImage.classList.contains("heart-loaded")||currentImage.classList.contains("heart-loading")||null===currentImage.currentSrc))if(currentImage.classList.add("heart-loading"),currentImage.complete&&0<currentImage.naturalWidth)loadHandler.bind(currentImage)();else{currentImage.onload=loadHandler.bind(currentImage);var atts=["sizes","srcset","src"];atts.forEach(function(attribute){var targetAtt=currentImage.getAttribute("data-"+attribute);targetAtt&&null==currentImage.getAttribute(attribute)&&(currentImage.setAttribute(attribute,targetAtt),currentImage.setAttribute("data-"+attribute,""))})}if(currentImage.classList.add("heart-loading"),currentImage.complete&&0<currentImage.naturalWidth)loadHandler.bind(currentImage)();else{currentImage.onload=loadHandler.bind(currentImage);var atts=["sizes","srcset","src"];atts.forEach(function(attribute){var targetAtt=currentImage.getAttribute("data-"+attribute);targetAtt&&null==currentImage.getAttribute(attribute)&&(currentImage.setAttribute(attribute,targetAtt),currentImage.setAttribute("data-"+attribute,""))})}});var currentVideos=Array.prototype.slice.call(targetSlide.querySelectorAll("video"));currentVideos&&0<currentVideos.length&&currentVideos.forEach((currentVideo,index)=>{if(null==currentVideo||currentVideo.classList.contains("heart-loaded")||currentVideo.classList.contains("heart-loading"))return;else{function loadHandler(){if(currentVideo.classList.add("heart-loaded"),currentVideo.classList.remove("heart-loading"),isFirstSlide&&0==index&&_this.kickstart(),console.log("%cFinished loading index: "+target,"font-style: italic; font-size: 0.9em; color: #757575; padding: 0.2em;"),!1===_this.settings.randomize||"all"!==_this.settings.randomize){const allVideos=Array.from(_this.slideshowSelector.querySelectorAll("video")),currentIndex=allVideos.indexOf(currentVideo);if(currentIndex===allVideos.length-1)return null;const nextVideoSlide=allVideos[currentIndex+1].closest(".heart-slide");if(null!==nextVideoSlide){const nextVideoSlideIndex=Array.from(_this.slides).indexOf(nextVideoSlide);_this.progressiveLoad(nextVideoSlideIndex)}}}currentVideo.muted="muted",currentVideo.removeAttribute("loop");const mustHaveAttributes=["playsinline","disablepictureinpicture","disableremoteplayback","preload"];if(mustHaveAttributes.forEach(attr=>{if(!currentVideo.getAttribute(attr)){let value="";"preload"===attr&&(value="auto"),currentVideo.setAttribute(attr,value)}}),currentVideo.onloadstart=()=>{currentVideo.classList.add("heart-loading")},currentVideo.oncanplaythrough=loadHandler.bind(currentVideo),""==currentVideo.src&&null!==currentVideo.getAttribute("data-src")&&(currentVideo.src=currentVideo.getAttribute("data-src"),currentVideo.removeAttribute("data-src")),0<currentVideo.querySelectorAll("source").length){const sources=currentVideo.querySelectorAll("source");let errorCount=0;for(const source of sources)""==source.src&&null!==source.getAttribute("data-src")&&(source.src=source.getAttribute("data-src"),source.removeAttribute("data-src")),source.onerror=()=>{errorCount++,this.removeEmptySlideAndReinit(target,errorCount,sources.length)}}currentVideo.load()}})}}removeEmptySlideAndReinit(target,errorCount,totalNumberOfSources){const currentSlide=this.slides[target];errorCount===totalNumberOfSources&&(this.slideshowSelector.removeChild(currentSlide),console.warn("removed slide based on error loading source:",currentSlide),this.reset(this.settings),0===target&&(this.slideshowSelector.classList.add("first-image-loaded"),_this.firstImageLoad&&_this.firstImageLoad(_this)))}prevNextHandler(targetIndex,indexToProgressiveLoad,isManuallyCalled){const _this=this;if(!0===_this.transitioning){if(!0===isManuallyCalled){_this.manualTimeout&&clearTimeout(_this.manualTimeout),_this.originallyPaused||(_this.manualTimeout=setTimeout(_this.resume(),_this.settings.transition+_this.settings.delay)),_this.progressiveLoad(indexToProgressiveLoad);var skipDefaultTransition=!0;let isFirstSlide=!1;return void _this.goToSlide(_this.index,isManuallyCalled,!1,!0)}return}!0===isManuallyCalled&&_this.progressiveLoad(indexToProgressiveLoad),_this.goToSlide(targetIndex,isManuallyCalled,!1,skipDefaultTransition),setTimeout(function(){_this.transitioning=!1},isManuallyCalled?_this.settings.manualTransition:_this.settings.transition)}clearAllTimers(){clearInterval(this.slideInterval),clearTimeout(this.manualTimeout),clearTimeout(this.kickoffTimer),clearTimeout(this.throttleClickResume),clearTimeout(this.videoSlideTimer),clearTimeout(this.visResumeTimer)}next=function(_this,isManuallyCalled){void 0===_this&&(_this=this),void 0===isManuallyCalled&&(isManuallyCalled=!1);var nextIndex=(_this.index+1+_this.total)%_this.total,indexToProgressiveLoad=(nextIndex+1+_this.total)%_this.total;_this.prevNextHandler(nextIndex,indexToProgressiveLoad,isManuallyCalled)};previous=function(_this,isManuallyCalled){void 0===_this&&(_this=this),void 0===isManuallyCalled&&(isManuallyCalled=!1);var previousIndex=(_this.index-1+_this.total)%_this.total,indexToProgressiveLoad=previousIndex;_this.prevNextHandler(previousIndex,indexToProgressiveLoad,isManuallyCalled)};resume=function(_this){void 0===_this&&(_this=this),console.log("resumed"),_this.settings.paused&&(_this.settings.paused=!1);var nextSlideIndex=(_this.index+1+_this.total)%_this.total;_this.settings.progressive&&setTimeout(function(){_this.progressiveLoad((nextSlideIndex+1+_this.total)%_this.total)},_this.settings.delay),_this.goToSlide(nextSlideIndex),this.slideInterval=setInterval(function(){_this.next(_this,!1)},_this.settings.delay+_this.settings.transition)};pause=function(_this){void 0===_this&&(_this=this),_this.settings.paused||(_this.settings.paused=!0,this.clearAllTimers())}}
